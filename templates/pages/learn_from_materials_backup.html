<!-- ä»èµ„æ–™å­¦ä¹ é¡µé¢ - åƒç´ çº§è¿˜åŸUI\ç¬”è®°.html -->
<style>
    /* ä¾§è¾¹æ æ”¶ç¼©æ ·å¼ */
    #sidebar.collapsed .sidebar-text,
    #sidebar.collapsed #user-profile,
    #sidebar.collapsed .logo-text {
        display: none;
    }
    #sidebar.collapsed .nav-item-icon {
        margin-right: 0;
    }
    #sidebar.collapsed .nav-link {
        justify-content: center;
    }
</style>

<div class="flex h-screen bg-white">
    

    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <div class="flex-1 flex bg-bg-light-blue-gray" id="main-content">
        <!-- æ–‡ä»¶ç»“æ„é¢æ¿ -->
        <div class="w-1/4 bg-white border-r border-gray-200 p-4 flex flex-col transition-all duration-300" id="file-structure">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-lg font-semibold text-text-dark-brown">æ–‡ä»¶ç»“æ„</h2>
                <div class="space-x-2">
                    <button class="text-text-gray hover:text-primary" onclick="createNewFolder()" title="æ–°å»ºæ–‡ä»¶å¤¹">
                        <span class="material-icons-outlined">create_new_folder</span>
                    </button>
                    <button class="text-text-gray hover:text-primary" onclick="createNewNote()" title="æ–°å»ºç¬”è®°">
                        <span class="material-icons-outlined">note_add</span>
                    </button>
                    <button class="text-red-600 hover:text-red-800" onclick="validateBackendFunctions()" title="éªŒè¯åç«¯åŠŸèƒ½">
                        <span class="material-icons-outlined">bug_report</span>
                    </button>
                </div>
            </div>
            
            <!-- æ–‡ä»¶æ ‘å®¹å™¨ -->
            <div class="flex-1 overflow-y-auto pr-2">
                <div id="loading-indicator" class="flex items-center justify-center py-8">
                    <div class="animate-spin">
                        <span class="material-icons-outlined text-primary">refresh</span>
                    </div>
                    <span class="ml-2 text-text-medium-brown">åŠ è½½æ–‡ä»¶ç»“æ„ä¸­...</span>
                </div>
                <ul class="space-y-1" id="file-tree">
                    <!-- ç¤ºä¾‹æ–‡ä»¶ç»“æ„ - å°†è¢«åŠ¨æ€æ›¿æ¢ -->
                    <li>
                        <div class="flex items-center p-2 rounded-md hover:bg-bg-light-gray cursor-pointer">
                            <span class="material-icons-outlined text-yellow-500 mr-2">folder</span>
                            <span class="text-text-dark-brown font-medium">é¡¹ç›®ç¬”è®°</span>
                            <span class="material-icons-outlined text-text-gray ml-auto">expand_more</span>
                        </div>
                        <ul class="pl-6 mt-1 space-y-1">
                            <li>
                                <div class="flex items-center p-2 rounded-md hover:bg-bg-light-gray cursor-pointer bg-bg-light-green">
                                    <span class="material-icons-outlined text-primary mr-2">description</span>
                                    <span class="text-primary font-semibold">æŸ¯åŸºå­¦ä¹ æ³•.md</span>
                                </div>
                            </li>
                            <li>
                                <div class="flex items-center p-2 rounded-md hover:bg-bg-light-gray cursor-pointer">
                                    <span class="material-icons-outlined text-gray-500 mr-2">description</span>
                                    <span class="text-text-medium-brown">äº§å“è®¾è®¡æ–‡æ¡£.md</span>
                                </div>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <div class="flex items-center p-2 rounded-md hover:bg-bg-light-gray cursor-pointer">
                            <span class="material-icons-outlined text-yellow-500 mr-2">folder</span>
                            <span class="text-text-dark-brown font-medium">æ—¥å¸¸éšç¬”</span>
                            <span class="material-icons-outlined text-text-gray ml-auto">chevron_right</span>
                        </div>
                    </li>
                    <li>
                        <div class="flex items-center p-2 rounded-md hover:bg-bg-light-gray cursor-pointer">
                            <span class="material-icons-outlined text-yellow-500 mr-2">folder</span>
                            <span class="text-text-dark-brown font-medium">ä¼šè®®çºªè¦</span>
                            <span class="material-icons-outlined text-text-gray ml-auto">chevron_right</span>
                        </div>
                    </li>
                </ul>
            </div>
        </div>

        <!-- ä¸»ç¼–è¾‘åŒºåŸŸ -->
        <main class="flex-1 p-6 flex flex-col">
            <header class="flex justify-between items-center mb-4">
                <h2 id="document-title" class="text-2xl font-bold text-text-dark-brown">æŸ¯åŸºå­¦ä¹ æ³•.md</h2>
                <div class="flex items-center space-x-2">
                    <button id="preview-btn" class="flex items-center bg-white border border-gray-300 px-3 py-1.5 rounded-lg text-text-gray hover:bg-gray-100" onclick="switchToPreview()">
                        <span class="material-icons-outlined text-sm mr-1">visibility</span>
                        <span>é¢„è§ˆ</span>
                    </button>
                    <button id="edit-btn" class="flex items-center bg-primary text-white px-3 py-1.5 rounded-lg hover:bg-green-600" onclick="switchToEdit()">
                        <span class="material-icons-outlined text-sm mr-1">edit</span>
                        <span>ç¼–è¾‘</span>
                    </button>
                </div>
            </header>
            
            <!-- æ–‡æ¡£å†…å®¹åŒºåŸŸ -->
            <div class="flex-1 bg-white rounded-xl shadow-sm p-6 overflow-y-auto" id="document-content">
                <div class="prose max-w-none">
                    <h1>æŸ¯åŸºå­¦ä¹ æ³•æ ¸å¿ƒåŸåˆ™</h1>
                    <p>æŸ¯åŸºå­¦ä¹ æ³•æ˜¯ä¸€ç§ä»¥<strong>å…´è¶£é©±åŠ¨</strong>å’Œ<strong>ç§¯æåé¦ˆ</strong>ä¸ºæ ¸å¿ƒçš„å­¦ä¹ æ–¹æ³•è®ºã€‚å®ƒæ¨¡ä»¿äº†æŸ¯åŸºçŠ¬æ´»æ³¼ã€å¥½å¥‡ã€èªæ˜çš„ç‰¹ç‚¹ï¼Œæ—¨åœ¨è®©å­¦ä¹ è¿‡ç¨‹å˜å¾—æ›´åŠ æœ‰è¶£å’Œé«˜æ•ˆã€‚</p>
                    <h2>åŸåˆ™ä¸€ï¼šä¿æŒå¥½å¥‡å¿ƒï¼ˆåƒæŸ¯åŸºä¸€æ ·æ¢ç´¢ï¼‰</h2>
                    <ul>
                        <li>ä¸»åŠ¨å‘ç°é—®é¢˜ï¼Œè€Œä¸æ˜¯è¢«åŠ¨æ¥å—çŸ¥è¯†ã€‚</li>
                        <li>å°†å¤§çš„å­¦ä¹ ç›®æ ‡åˆ†è§£æˆä¸€ä¸ªä¸ª"å°ç©å…·"ï¼Œé€ä¸ªæ”»ç ´ã€‚</li>
                        <li>å‹‡äºå°è¯•æ–°é¢†åŸŸï¼Œä¸æ€•çŠ¯é”™ã€‚</li>
                    </ul>
                    <h2>åŸåˆ™äºŒï¼šçŸ­æ—¶é«˜æ•ˆï¼ˆæŸ¯åŸºçš„ç²¾åŠ›é›†ä¸­æ—¶é—´ï¼‰</h2>
                    <p>ç ”ç©¶è¡¨æ˜ï¼ŒæŸ¯åŸºçš„æ³¨æ„åŠ›é›†ä¸­æ—¶é—´ä¸é•¿ï¼Œè¿™å¯å‘æˆ‘ä»¬åº”è¯¥é‡‡ç”¨ç•ªèŒ„å·¥ä½œæ³•ä¹‹ç±»çš„æŠ€å·§ï¼Œè¿›è¡ŒçŸ­æ—¶é—´ã€é«˜å¼ºåº¦çš„å­¦ä¹ ã€‚</p>
                    <pre><code>// ä¼ªä»£ç ç¤ºä¾‹
function corgiStudy(sessionTime = 25, breakTime = 5) {
  while(learning) {
    focus(sessionTime);
    play(breakTime);
  }
}</code></pre>
                    <h2>åŸåˆ™ä¸‰ï¼šåŠæ—¶å¥–åŠ±ï¼ˆå¾—åˆ°å°é›¶é£Ÿçš„å¿«ä¹ï¼‰</h2>
                    <p>æ¯å®Œæˆä¸€ä¸ªå°çš„å­¦ä¹ ä»»åŠ¡ï¼Œå°±ç»™è‡ªå·±ä¸€ä¸ªç§¯æçš„åé¦ˆã€‚å¯ä»¥æ˜¯ä¸€æ¯å’–å•¡ã€ä¸€é›†å–œæ¬¢çš„å‰§ï¼Œæˆ–è€…åªæ˜¯ç®€å•çš„è‡ªæˆ‘è‚¯å®šã€‚</p>
                    <blockquote>"æ±ªï¼æˆ‘çœŸæ£’ï¼"</blockquote>
                </div>
            </div>
        </main>

        <!-- å³ä¾§çŸ¥è¯†ç‚¹é¢æ¿ -->
        <aside class="w-1/5 bg-white border-l border-gray-200 p-4 flex flex-col">
            <h2 class="text-lg font-semibold text-text-dark-brown mb-4">çŸ¥è¯†ç‚¹åˆ—è¡¨</h2>
            <div class="flex-1 overflow-y-auto space-y-3" id="knowledge-points">
                <div class="bg-bg-light-green p-3 rounded-lg cursor-pointer hover:shadow-md transition-shadow">
                    <h3 class="font-semibold text-primary">å…´è¶£é©±åŠ¨</h3>
                    <p class="text-sm text-text-medium-brown mt-1">å­¦ä¹ çš„æ ¸å¿ƒåŠ¨åŠ›æ¥æºï¼Œæé«˜ä¸»åŠ¨æ€§ã€‚</p>
                </div>
                <div class="bg-bg-light-gray p-3 rounded-lg cursor-pointer hover:shadow-md transition-shadow">
                    <h3 class="font-semibold text-text-dark-brown">ç§¯æåé¦ˆ</h3>
                    <p class="text-sm text-text-medium-brown mt-1">é€šè¿‡å¥–åŠ±æœºåˆ¶å·©å›ºå­¦ä¹ æˆæœï¼Œæå‡åŠ¨æœºã€‚</p>
                </div>
                <div class="bg-bg-light-gray p-3 rounded-lg cursor-pointer hover:shadow-md transition-shadow">
                    <h3 class="font-semibold text-text-dark-brown">ç•ªèŒ„å·¥ä½œæ³•</h3>
                    <p class="text-sm text-text-medium-brown mt-1">ä¸€ç§æ—¶é—´ç®¡ç†æ–¹æ³•ï¼Œç”¨äºä¿æŒä¸“æ³¨ã€‚</p>
                </div>
            </div>
        </aside>
    </div>
</div>

<script>
(function() {
    // ä½¿ç”¨å…¨å±€è°ƒè¯•å‡½æ•°
    function debugLog(message) {
        if (window.globalDebugLog) {
            window.globalDebugLog(message);
        } else {
            console.log(message);
        }
    }

    function debugError(message) {
        if (window.globalDebugError) {
            window.globalDebugError(message);
        } else {
            console.error(message);
        }
    }

    // é¡µé¢åˆå§‹åŒ–
    debugLog('ä»èµ„æ–™å­¦ä¹ é¡µé¢è„šæœ¬åŠ è½½');
    debugLog('å½“å‰æ—¶é—´: ' + new Date().toLocaleTimeString());
    debugLog('document.readyState: ' + document.readyState);

    // å…¨å±€å˜é‡
    let currentFilePath = null;
    let currentMode = 'preview';
    let selectedTreeItem = null;

    // ä¾§è¾¹æ æ”¶ç¼©åŠŸèƒ½
    function toggleSidebar() {
        const sidebar = document.getElementById('sidebar');
        const fileStructure = document.getElementById('file-structure');
        sidebar.classList.toggle('collapsed');
        const isCollapsed = sidebar.classList.contains('collapsed');
        
        if (isCollapsed) {
            fileStructure.classList.add('hidden');
            sidebar.classList.remove('w-64');
            sidebar.classList.add('w-20');
        } else {
            fileStructure.classList.remove('hidden');
            sidebar.classList.remove('w-20');
            sidebar.classList.add('w-64');
        }
        
        const chevron = document.getElementById('toggle-icon');
        if (isCollapsed) {
            chevron.textContent = 'chevron_right';
        } else {
            chevron.textContent = 'chevron_left';
        }
    }

    // é¡µé¢åˆå§‹åŒ–å‡½æ•°
    function initializePage() {
        debugLog('é¡µé¢åˆå§‹åŒ–å¼€å§‹');
        
        if (window.bridge && typeof window.bridge.getFileStructure === 'function') {
            debugLog('Bridgeå·²å¯ç”¨ï¼Œç›´æ¥åŠ è½½æ–‡ä»¶ç»“æ„');
            loadFileStructure();
            return;
        }
        
        if (typeof QWebChannel !== 'undefined' && window.qt && window.qt.webChannelTransport) {
            debugLog('å¼€å§‹WebChannelåˆå§‹åŒ–');
            initializeWebChannel();
        } else {
            debugLog('å»¶è¿Ÿ500msåé‡è¯•åˆå§‹åŒ–');
            setTimeout(initializeWebChannel, 500);
        }
    }

    // åˆå§‹åŒ–WebChannelè¿æ¥
    function initializeWebChannel() {
        debugLog('å¼€å§‹åˆå§‹åŒ–WebChannelè¿æ¥');
        
        if (typeof QWebChannel !== 'undefined' && window.qt && window.qt.webChannelTransport) {
            debugLog('QWebChannelå’Œtransportéƒ½å¯ç”¨');
            
            new QWebChannel(window.qt.webChannelTransport, function(channel) {
                debugLog('WebChannelè¿æ¥æˆåŠŸï¼');
                window.bridge = channel.objects.bridge;
                debugLog('Bridgeå¯¹è±¡è®¾ç½®å®Œæˆ: ' + (window.bridge ? 'success' : 'failed'));
                
                if (window.bridge) {
                    debugLog('Bridgeå¯¹è±¡å¯ç”¨ï¼Œå¼€å§‹åŠ è½½æ–‡ä»¶ç»“æ„');
                    loadFileStructure();
                } else {
                    debugError('Bridgeå¯¹è±¡æœªèƒ½æ­£ç¡®è®¾ç½®');
                }
            });
        } else {
            debugError('QWebChannelæˆ–transportä¸å¯ç”¨ï¼Œæ— æ³•åˆå§‹åŒ–');
            setTimeout(initializeWebChannel, 1000);
        }
    }

    // åŠ è½½æ–‡ä»¶ç»“æ„
    function loadFileStructure() {
        debugLog('å¼€å§‹åŠ è½½æ–‡ä»¶ç»“æ„');
        
        if (!window.bridge || typeof window.bridge.getFileStructure !== 'function') {
            debugError('Bridgeå¯¹è±¡æˆ–getFileStructureæ–¹æ³•ä¸å¯ç”¨');
            return;
        }
        
        try {
            const startTime = Date.now();
            window.bridge.getFileStructure(function(structureJson) {
                debugLog('ä»Pythonæ¥æ”¶åˆ°æ•°æ®ï¼Œè€—æ—¶: ' + (Date.now() - startTime) + 'ms');
                debugLog('æ•°æ®é•¿åº¦: ' + (structureJson ? structureJson.length : 'null'));
                parseAndRenderFileStructure(structureJson);
            });
        } catch (error) {
            debugError('è°ƒç”¨getFileStructureæ—¶å‘ç”Ÿé”™è¯¯: ' + error.message);
        }
    }

    // è§£æå¹¶æ¸²æŸ“æ–‡ä»¶ç»“æ„
    function parseAndRenderFileStructure(structureJson) {
        try {
            const structure = JSON.parse(structureJson);
            debugLog('JSONè§£ææˆåŠŸï¼Œæ•°ç»„é•¿åº¦: ' + (structure ? structure.length : 'null'));
            renderFileTree(structure);
        } catch (e) {
            debugError('JSONè§£æå¤±è´¥: ' + e.message);
        }
    }

    // æ¸²æŸ“æ–‡ä»¶æ ‘
    function renderFileTree(structure) {
        debugLog('å¼€å§‹æ¸²æŸ“æ–‡ä»¶æ ‘');
        
        const fileTree = document.getElementById('file-tree');
        const loadingIndicator = document.getElementById('loading-indicator');
        
        if (loadingIndicator) {
            loadingIndicator.remove();
            debugLog('å·²ç§»é™¤åŠ è½½æŒ‡ç¤ºå™¨');
        }
        
        if (structure && structure.length > 0) {
        }
        
        let html = '<ul class="space-y-1">';
        data.forEach(item => {
            html += renderFileItem(item, 0);
                            <span class="${isSelected ? 'text-primary font-semibold' : 'text-text-medium-brown'}">${item.name}</span>
                        </div>
                    </li>
                `;
            }
        });
        return html;
    }

    // åˆ‡æ¢æ–‡ä»¶å¤¹å±•å¼€/æŠ˜å 
    function toggleFolder(element, folderPath) {
        const chevron = element.querySelector('.material-icons-outlined:last-child');
        const folderList = element.nextElementSibling;
        
        if (folderList.classList.contains('hidden')) {
            folderList.classList.remove('hidden');
            chevron.textContent = 'expand_more';
        } else {
            folderList.classList.add('hidden');
            chevron.textContent = 'chevron_right';
        }
    }

    // é€‰æ‹©æ–‡ä»¶
    function selectFile(filePath, fileName) {
        debugLog('é€‰æ‹©æ–‡ä»¶: ' + fileName);
        
        // æ›´æ–°æ–‡æ¡£æ ‡é¢˜
        document.getElementById('document-title').textContent = fileName;
        
        // ç§»é™¤ä¹‹å‰çš„é€‰ä¸­çŠ¶æ€
        document.querySelectorAll('.bg-bg-light-green').forEach(el => {
            el.classList.remove('bg-bg-light-green');
            const icon = el.querySelector('.material-icons-outlined');
            const text = el.querySelector('span:last-child');
            if (icon) {
                icon.classList.remove('text-primary');
                icon.classList.add('text-gray-500');
            }
            if (text) {
                text.classList.remove('text-primary', 'font-semibold');
                text.classList.add('text-text-medium-brown');
            }
        });
        
        // æ·»åŠ æ–°çš„é€‰ä¸­çŠ¶æ€
        event.currentTarget.classList.add('bg-bg-light-green');
        const icon = event.currentTarget.querySelector('.material-icons-outlined');
        const text = event.currentTarget.querySelector('span:last-child');
        if (icon) {
            icon.classList.remove('text-gray-500');
            icon.classList.add('text-primary');
        }
        if (text) {
            text.classList.remove('text-text-medium-brown');
            text.classList.add('text-primary', 'font-semibold');
        }
        
        currentFilePath = filePath;
        
        // åŠ è½½æ–‡ä»¶å†…å®¹
        if (window.bridge && window.bridge.loadMarkdownFile) {
            window.bridge.loadMarkdownFile(filePath, function(content) {
                document.getElementById('document-content').innerHTML = content;
            });
        }
    }

    // é¢„è§ˆ/ç¼–è¾‘æ¨¡å¼åˆ‡æ¢
    function switchToPreview() {
        document.getElementById('preview-btn').classList.add('bg-white', 'border-gray-300', 'text-text-gray');
        document.getElementById('preview-btn').classList.remove('bg-primary', 'text-white');
        document.getElementById('edit-btn').classList.remove('bg-white', 'border-gray-300', 'text-text-gray');
        document.getElementById('edit-btn').classList.add('bg-primary', 'text-white');
    }

    function switchToEdit() {
        document.getElementById('edit-btn').classList.add('bg-white', 'border-gray-300', 'text-text-gray');
        document.getElementById('edit-btn').classList.remove('bg-primary', 'text-white');
        document.getElementById('preview-btn').classList.remove('bg-white', 'border-gray-300', 'text-text-gray');
        document.getElementById('preview-btn').classList.add('bg-primary', 'text-white');
    }

    // æ–‡ä»¶æ“ä½œå‡½æ•°
    function createNewNote() {
        debugLog('åˆ›å»ºæ–°ç¬”è®°');
        if (window.bridge && window.bridge.createNewNote) {
            window.bridge.createNewNote('vault', function(result) {
                debugLog('æ–°ç¬”è®°åˆ›å»ºç»“æœ: ' + result);
                loadFileStructure();
            });
        }
    }

    function createNewFolder() {
        debugLog('åˆ›å»ºæ–°æ–‡ä»¶å¤¹');
        if (window.bridge && window.bridge.createNewFolder) {
            window.bridge.createNewFolder('vault', function(result) {
                debugLog('æ–°æ–‡ä»¶å¤¹åˆ›å»ºç»“æœ: ' + result);
                loadFileStructure();
            });
        }
    }

    // éªŒè¯åç«¯åŠŸèƒ½
    function validateBackendFunctions() {
        debugLog('ğŸ” å¼€å§‹éªŒè¯åç«¯åŠŸèƒ½');
        
        if (!window.bridge || typeof window.bridge.validateAllFileOperations !== 'function') {
            debugError('âŒ Bridgeå¯¹è±¡æˆ–validateAllFileOperationsæ–¹æ³•ä¸å¯ç”¨');
            alert('âŒ æ— æ³•è¿æ¥åˆ°åç«¯éªŒè¯æœåŠ¡');
            return;
        }
        
        // æ˜¾ç¤ºéªŒè¯å¼€å§‹æç¤º
        const loadingDiv = document.createElement('div');
        loadingDiv.id = 'validation-loading';
        loadingDiv.className = 'fixed top-4 right-4 bg-blue-500 text-white px-4 py-2 rounded-lg shadow-lg z-50';
        loadingDiv.innerHTML = `
            <div class="flex items-center">
                <div class="animate-spin mr-2">
                    <span class="material-icons-outlined">refresh</span>
                </div>
                <span>æ­£åœ¨éªŒè¯åç«¯åŠŸèƒ½...</span>
            </div>
        `;
        document.body.appendChild(loadingDiv);
        
        debugLog('è°ƒç”¨åç«¯éªŒè¯åŠŸèƒ½...');
        
        try {
            window.bridge.validateAllFileOperations(function(result) {
                debugLog('ğŸ¯ åç«¯éªŒè¯å®Œæˆ');
                debugLog('éªŒè¯ç»“æœ: ' + result);
                
                // ç§»é™¤åŠ è½½æç¤º
                const loadingElement = document.getElementById('validation-loading');
                if (loadingElement) {
                    loadingElement.remove();
                }
                
                // æ˜¾ç¤ºéªŒè¯ç»“æœ
                const resultDiv = document.createElement('div');
                resultDiv.className = 'fixed top-4 right-4 bg-white border border-gray-300 rounded-lg shadow-lg z-50 max-w-md p-4';
                resultDiv.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="font-semibold text-gray-800">åç«¯åŠŸèƒ½éªŒè¯ç»“æœ</h3>
                        <button onclick="this.parentElement.parentElement.remove()" class="text-gray-500 hover:text-gray-700">
                            <span class="material-icons-outlined text-sm">close</span>
                        </button>
                    </div>
                    <div class="text-sm text-gray-600 whitespace-pre-line max-h-64 overflow-y-auto">
                        ${result}
                    </div>
                `;
                document.body.appendChild(resultDiv);
                
                // 5ç§’åè‡ªåŠ¨å…³é—­
                setTimeout(() => {
                    if (resultDiv.parentElement) {
                        resultDiv.remove();
                    }
                }, 10000);
                
                // é‡æ–°åŠ è½½æ–‡ä»¶ç»“æ„ä»¥åæ˜ ä»»ä½•æ›´æ”¹
                loadFileStructure();
            });
        } catch (error) {
            debugError('è°ƒç”¨åç«¯éªŒè¯æ—¶å‘ç”Ÿé”™è¯¯: ' + error.message);
            
            // ç§»é™¤åŠ è½½æç¤º
            const loadingElement = document.getElementById('validation-loading');
            if (loadingElement) {
                loadingElement.remove();
            }
            
            alert('âŒ éªŒè¯è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯: ' + error.message);
        }
    }

    // å¯¼èˆªå‡½æ•°ï¼ˆå…¼å®¹SPAï¼‰
    function loadContent(contentId) {
        if (window.bridge && window.bridge.loadContent) {
            window.bridge.loadContent(contentId);
        }
    }

    // å°†å‡½æ•°æš´éœ²åˆ°å…¨å±€ä½œç”¨åŸŸ
    window.toggleSidebar = toggleSidebar;
    window.toggleFolder = toggleFolder;
    window.selectFile = selectFile;
    window.switchToPreview = switchToPreview;
    window.switchToEdit = switchToEdit;
    window.createNewNote = createNewNote;
    window.createNewFolder = createNewFolder;
    window.validateBackendFunctions = validateBackendFunctions;
    window.loadContent = loadContent;

    // é¡µé¢åˆå§‹åŒ–
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initializePage);
    } else {
        initializePage();
    }

})();
</script>
